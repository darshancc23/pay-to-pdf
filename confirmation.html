<!DOCTYPE html>
<html>
<head>
    <title>Confirmation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.3.3/semantic.min.css"/>
    <style>
        #box-container {
            margin-top: 150px;
        }
    </style>
</head>
<body>
<div id="box-container">
    <div class="ui raised very padded text container segment">
        <h2 class="ui huge header">Thank You for Showing Interest</h2>
        <p>Please click the below button to pay</p>
        <button id="rzp-button1" class="ui purple basic button" type="submit">Pay with Razorpay</button>
    </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.debug.js"></script>
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
    function pdf() {
        let name = window.localStorage.getItem("name");
        let email = window.localStorage.getItem("email");
        /* temporarily setting date to current date of pdf receipt issue
        should probably be stored to localStorage along with name and email */
        let date = new Date().toDateString();
        let doc = new jsPDF();
        doc.setFontSize(26);
        doc.setTextColor(92, 76, 76);
        doc.text(20, 20, 'Transaction Details');
        doc.setLineWidth(0.5);
        doc.setDrawColor(214,214,214);
        doc.line(20, 30, 180, 30);
        doc.setFontSize(18);
        doc.text(20, 45, 'Name: ' + name);
        doc.text(20, 65, 'Email: ' + email);
        doc.text(20, 85, 'Transaction Date: ' + date);
        doc.text(20, 105, 'Transaction ID: jxB9ZZcuwZ'); // temp ID value
        doc.text(20, 125, 'Transaction Type: Order'); // default Order for now, but this may not be needed
        doc.text(20, 145, 'Payment Method: ' + 'Credit Card'); // should change based on Razorpay options
        doc.text(20, 165, 'Charged Amount: '+ '200.00 Rupees'); // This should be received from Razorpay
        doc.text(20, 185, 'Status: '+ 'Success');
        doc.save('payment_details.pdf');
        window.localStorage.clear();
    }
</script>
<script>
    (function () {
        let name = window.localStorage.getItem("name");
        let email = window.localStorage.getItem("email");
        let options = {
            "key": "rzp_test_Y3ZqWJHAv7fVti",
            "amount": "20000",
            "name": "Organization name",
            "description": "Event Name",
            "image": "/your_logo.png",
            "handler": (response) => {
                setTimeout(function () {
                    pdf();
                    window.location = "./index.html";
                }, 2000);
            },
            "prefill": {
                "email": email
            },
            "theme": {
                "color": "#222"
            }
        };
        let rzp1 = new Razorpay(options);

        document.getElementById('rzp-button1').onclick = function (e) {
            rzp1.open();
            e.preventDefault();
        }
    })();
</script>
</body>
</html>
